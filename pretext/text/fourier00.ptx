<?xml version="1.0" encoding="UTF-8" ?>
<chapter xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="chap_fourier">
<!-- Copyright 2018-2020 Joel Feldman, Andrew Rechnitzer and Elyse Yeager -->
<!-- This work is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License-->
<!-- https://creativecommons.org/licenses/by-nc-sa/4.0 -->
<!-- This chapter added by Killian O'Brien in November 2022 -->
<title>Fourier series</title>
<introduction>
  <p>
    In this chapter we learn how to express certain periodic functions as series of sine and cosine functions. Such a series is called a Fourier series. This and other aspects of Fourier analysis find important applications in the field of sound processing (and signal processing in general).
  </p>
  <p>
    This chapter was added by Killian O'Brien in November 2022. 
  </p>
  </introduction>
  <section xml:id="sec-fourier_defs">
    <title>Fourier's theorem and initial definitions</title>
    <theorem xml:id="thm-fourier">
      <statement>
        <p>
          If <m>f: \mathbb{R} \to \mathbb{R}</m> is a periodic function of period <m>2 \pi</m> and in the interval <m>(-\pi, \pi)</m> has
          <ol>
            <li>
              <p>
                at most a finite number of discontinuities ,
              </p>
            </li>
            <li>
              <p>
                at most a finite number of maxima and minima,
              </p>
            </li>
          </ol>
          then there exist a set of coefficients
          <me>
            a_0, a_1, a_2, \dots , b_1, b_2 , \dots \in \mathbb{R},
          </me>
          such that at any point of <m>x</m> of continuity of <m>f</m> 
          we have
          <me>
            f(x) = \frac{1}{2} a_0 + \sum_{n=1}^\infty a_n \cos(nx) + \sum_{n=1}^\infty b_n \sin(nx),
          </me>
          and at points of discontinuity, <m>x_d</m>, the series satisfies
          <me>
            \frac{1}{2} \left ( f(x_d^+) + f(x_d^-) \right ) =
\frac{1}{2} a_0 + \sum_{n=1}^\infty a_n \cos(nx) + \sum_{n=1}^\infty b_n \sin(nx),
          </me>
          where
          <me>
          f(x_d^+) = \lim_{x \downarrow x_d} f(x), \quad
          f(x_d^-) = \lim_{x \uparrow x_d} f(x).            
          </me>
        </p>
      </statement>
    </theorem>
    <p>
      The series of sines and cosines is referred to as the Fourier series for <m>f</m>. It agrees with <m>f</m> at all points of continuity of <m>f</m> and takes the average value of the left and right-handed limits of <m>f</m> at points of discontinuity.
      </p>
      <p>
        The problem of finding a Fourier series for a given function <m>f</m> is the problem of determining the values of the <em>Fourier coefficients</em> <m>a_0, a_n , b_n, \, \, (n \geq 1)</m>, of <m>f</m>.
      </p>

      <p>
        The existence of Fourier series, and the method for finding the coefficients rely on the fact that the family of functions
        <me>
        F= \left \{ 1, \cos(nx), \sin(nx) \, : \,  n \geq 1 \right \},
        </me>
        form an <em>orthogonal basis</em> for the infinite-dimensional vector space of functions satisfying the conditions in Fourier's theorem with respect to the inner-product
        <me>
          \langle \phi, \psi \rangle = \int_{-\pi}^\pi \phi(x) \psi(x) \, dx .
        </me>
        That is
        <me>
           \forall \phi, \psi \in F , \phi \neq \psi \Rightarrow \langle \phi, \psi \rangle = 0.
        </me>
      </p>
  <p>
    The various cases of the orthogonality of <m>F</m> can be proved by evaluating the integrals using standard trigonometric substitutions. 
    </p>
  <example>
    <p>
    Show that the functions <m>\phi(x)=\cos(mx)</m> and <m>\psi(x)=\sin(nx)</m> are orthogonal with respect to <m>\langle \, \,  , \,  \rangle</m>.
    </p>
  </example>
  <example>
    <p>
      Evaluate <m>\langle \phi, \psi \rangle</m> when <m>\phi(x) = \psi(x) =
\sin(nx)</m>.
    </p>
  </example>
  </section>
  <section xml:id="sec-fourier_coeffs">
    <title>Determining the Fourier coefficients</title>
    <p>
      The Fourier coefficients for a given function <m>f</m> can be found by evaluating the integral formulae.
      <md>
        <mrow>a_0  \amp = \frac{1}{\pi} \int_{-\pi}^\pi f(x) \, dx,</mrow>
        <mrow>a_n \amp = \frac{1}{\pi} \int_{-\pi}^\pi f(x) \cos(nx) \, dx, \quad (n \geq 1)</mrow>
        <mrow>b_n \amp = \frac{1}{\pi} \int_{-\pi}^\pi f(x) \sin(nx) \, dx \quad (n \geq 1).</mrow>
      </md>
      These can be justified by starting with the Fourier series for <m>f</m> and applying the orthogonality property of the inner product.
    </p>
    
    <example>
      <statement>
        <p>
          Let <m>m</m> be an integer greater than <m>1</m>. Use the the Fourier series
          <me>
            f(x) = \frac{1}{2} a_0 + \sum_{n=1}^\infty a_n \cos(nx) + \sum_{n=1}^\infty b_n \sin(nx),
          </me>
to find an expression for <m>\langle f, \sin(mx) \rangle</m> and show how this produces the above formula for determining the Fourier coefficient <m>b_m</m>.

A similar argument will produce the formulae for <m>a_0</m> and <m>a_m</m>, <m>m \geq 1</m>.
        </p>
      </statement>
      <solution>
        <p>
          In lectures.
        </p>
      </solution>
    </example>
    
<p>
  By evaluating these integrals we can determine the Fourier series representation of some familiar functions.
</p>
<example>
  <statement>
    <p>
      Show that the Fourier series for the square wave function <m>f</m> defined by
<me>
f(x) = \begin{cases} 0 \amp \mbox{if } -\pi \lt x \lt 0 \\
1 \amp \mbox{if } 0 \leq x \leq \pi . \end{cases}
</me>
is given by
<md>
<mrow>  f(x) \amp = \frac{1}{2} + \frac{2}{\pi} \left (\sin(x) + \frac{1}{3}\sin(3x) + \frac{1}{5} \sin(5x) + \dots \right ),</mrow>
<mrow> \amp = \frac{1}{2} + \frac{2}{\pi} \sum_{n=1}^\infty \frac{1}{2n-1} \sin \big((2n-1)x\big),</mrow>
</md>
and verify that the series has the required value at the point of discontinuity <m>x=0</m>.
    </p>
  </statement>
  <solution>
    <p>
      In lecture. 
    </p>
  </solution>
</example>

<example>
  <statement>
    <p>
      Evaluating Fourier series at particular points can generate interesting series formulae. For instance, use evaluation at <m>x=\frac{\pi}{2}</m> of the Fourier series for the square wave to obtain the following formula for <m>\pi</m>,
<me>
\pi = 4 \sum_{m=1}^\infty \frac{(-1)^{m+1}}{2m -1} .
</me>
    </p>
  </statement>
  <solution>
    <p>
     In lecture. 
    </p>
  </solution>
</example>

    
  </section>
<section xml:id="sec-fourier_arbitrary">
  <title>Fourier series on arbitrary intervals</title>
  <p>
    Fourier series by their nature are periodic as they are generated by the periodic sine and cosine functions. However we can extend the concept to generate functions with period other than <m>2\pi</m> in the following way.</p>
<p>
Consider the transformation
<me>
t = \frac{\pi x}{T}.
</me>
As the variable <m>x</m> ranges from <m> -T</m> to <m>T</m>, the variable <m>t</m> ranges from <m> -\pi</m> to <m>\pi</m>. We can then show that if <m>f</m> is a function of period <m>2T</m> (which is well-behaved as described in Fourier's theorem) then <m>f</m> has a Fourier series
<me>
f(x) = \frac{1}{2} a_0 + \sum_{n=1}^\infty a_n \cos \left ( \frac{nx\pi}{T}\right ) + \sum_{n=1}^\infty b_n \sin\left ( \frac{nx\pi}{T}\right ) ,
</me>
where the Fourier coefficients are given by
<md>
<mrow>a_0 \amp = \frac{1}{T} \int_{-T}^T f(x) \, dx,</mrow>
<mrow> a_n \amp = \frac{1}{T} \int_{-T}^T f(x) \cos\left ( \frac{nx\pi}{T}\right )  \, dx, \quad (n \geq 1)</mrow>
<mrow>b_n \amp = \frac{1}{T} \int_{-T}^T f(x) \sin\left ( \frac{nx\pi}{T}\right )  \, dx \quad (n \geq 1).</mrow>
</md>
</p>
</section>
<section xml:id="sec-fourier_od_even">
  <title>Odd and even functions</title>
  <p>
    Certain symmetry properties of functions can be reflected in their Fourier series.
  </p>
  <definition xml:id="def-fourier-odd_even">
    <title>Odd and even functions</title>
     <statement>
      <p>
        A function <m>f:\mathbb{R} \to \mathbb{R}</m> is called <em>even</em> if and only if
        <me>
          \forall x \in \mathbb{R}, \, f(-x)=f(x).
        </me>
         A function <m>f:\mathbb{R} \to \mathbb{R}</m> is called <em>odd</em> if and only if
        <me>
          \forall x \in \mathbb{R}, \, f(-x)=-f(x).
        </me>
      </p>
      <p>
        The graph of an even function is symmetric under reflection in the <m>y</m>-axis. Whereas the graph of an odd function is symmetric under rotation about the origin by <m>\pi</m> radians.
      </p>
    </statement>
  </definition>
  <example>
    <statement>
    <p>
      The cosine function <m>\cos(x)</m> is even, while the sine function <m>\sin(x)</m> is odd. Is the function <m>f(x)=x^n</m> odd/even? Give an example of a function which is neither odd nor even. There is one function which is both odd and even. Which is it?
      </p>
      </statement>
      <solution>
        <p>
          In lecture.
        </p>
      </solution>
  </example>
  <p>
    Odd and even functions behave systematically when we multiply them together.
  </p>
  <theorem xml:id="thm-fourier_odd_even">
    <statement>
      <p>
        Products of odd and even functions obey the following rules,
        <ol>
          <li>
            <p>
            the product of two even funcctions is even,
            </p>
          </li>
          <li>
            <p>
              the product of two odd functions is even,
            </p>
          </li>
          <li>
            <p>
              the product of an odd function and an even function is odd.
            </p>
          </li>
        </ol>
        <alert>Warning:</alert> this multiplicative behaviour of odd and even functions does not match the multiplicative behaviour of odd and even <em>integers</em>! Make sure you do not confuse the two uses of the terms <em>odd</em> and <em>even.</em>
      </p>
    </statement>
    <proof>
      <p>
        In lecture.
      </p>
    </proof>
  </theorem>
  <p>
    Odd and even functions also have systematic behaviour when integrated over intervals centred at <m>0</m>. 
  </p>
<theorem xml:id="thm-fourier_odd_even_int">
  <statement>
    <p>
      Suppose that <m>g</m> is an even function and <m>h</m> is an odd function. Then for any <m>T</m>,
      <ul>
        <li>
          <p>
             <me>
              \int_{-T}^T g(x) \, dx = 2 \int_0^T g(x) \, dx,
             </me>
              
          </p>
        </li>
        <li>
          <p>
            <me>
              \int_{-T}^T h(x) \, dx = 0.
            </me>
          </p>
        </li>
      </ul>
    </p>
  </statement>
  <proof>
    <p>
      In lecture. 
    </p>
  </proof>
</theorem>
<p>
  Applying these results to the integral formulae for Fourier coefficients we can prove the following results on Fourier series of even and odd functions.
</p>
<theorem xml:id="thm-fourier_even_series">
  <title>Fourier series of even functions</title>
   <statement>
    <p>
      Suppose that <m>g</m> is an even function with a Fourier series. Then its series takes the form
<me>
g(x) = \frac{1}{2} a_0 + \sum_{n=1}^\infty a_n \cos(nx),
</me>
i.e. the sine Fourier coefficients are all zero. Moreover the <m>a_n</m> can be given by the formula
<me>
a_n = \frac{2}{\pi} \int_0^\pi g(x) \cos(nx) .
</me>
    </p>
  </statement>
</theorem>

<theorem xml:id="thm-fourier_odd_series">
  <title>Fourier series of odd functions</title>
   <statement>
    <p>
      Suppose that <m>h</m> is an odd function with a Fourier series. Then its series takes the form
<me>
h(x) = \sum_{n=1}^\infty b_n \sin(nx),
</me>
i.e. the cosine and constant Fourier coefficients are all zero. Moreover the <m>b_n</m> can be given by the formula
<me>
b_n = \frac{2}{\pi} \int_0^\pi g(x) \sin(nx) .
</me>
    </p>
  </statement>
</theorem>

<example>
  <statement>
    <p>
Use the concept of odd/even functions to show that the Fourier series for the function <m>f</m> defined by
<me>
  f(x) = x^2,
</me>
is given by
<me>
f(x) = x^2 = \frac{\pi^2}{3} + 4 \sum_{n=1}^\infty \frac{(-1)^n}{n^2} \cos(nx) .
</me>
    </p>
  </statement>
  <solution>
    <p>
      In lecture.
    </p>
  </solution>
</example>
<p>
  Sometimes attention is only focused on the behaviour of a function <m>f</m> over half its range, i.e. looking at <m>f(x)</m> for <m>x \in (0 , \pi)</m>. Before finding the Fourier series we can alter the definition of <m>f</m> over the other half, <m>(-\pi,0)</m>, of its domain, in order to make <m>f</m> even or odd as we wish. In this way we can arrange that the resulting Fourier series is either a cosine series (one which consists of a constant term and cosine functions only) or a sine series (one which consists of sine functions only).
</p>
<example>
  <statement>
    <p>
      Obtain a cosine Fourier series for the function <m>g</m> defined by,
<me>
  g(x)=x
  </me>
over the range <m>x \in (0, \infty)</m>.
Use this Fourier series to obtain an interesting infinite series expression involving <m>\pi</m>.
    </p>
  </statement>
  <solution>
    <p>
      In lecture.4
    </p>
  </solution>
</example>
</section>
<section xml:id="sec-fourier_convergence">
  <title>Convergence of Fourier series</title>
  <p>
    Consider the Fourier series for <m>f(x)=x</m> over the range <m>(-\pi, \pi)</m> which is
<md>
  <mrow>x \amp = 2 \sum_{n=1}^\infty \frac{(-1)^{n+1}}{n} \sin(nx)</mrow>
  <mrow>\amp = 2 \left ( \sin(x) - \frac{1}{2} \sin(2x) + \frac{1}{3} \sin(3x) - \frac{1}{4} \sin(4x) + \dots \right ).</mrow>
  </md>
Suppose we attempt to differentiate both sides of this equation, doing so term-by-term to the right hand side. This will produce the equation
<me>
1 = 2  \big ( \cos(x) - \cos(2x) + \cos(3x) - \cos(4x) + \dots  \big ).
</me>
However if we evaluate both sides of this equation at <m>x=0</m> we get
<me>
1 = 2 (1 - 1 + 1 - 1 + \dots ),
</me>
which is plainly nonsense. The problem is that we have assumed we could differentiate the right hand side of the Fourier series term-by-term, i.e. we assumed that
<me>
\frac{d}{dx} \left ( \sum_{n=1}^\infty b_n \sin(nx) \right ) = \sum_{n=1}^\infty \frac{d}{dx} \left ( b_n \sin(nx) \right ).
</me>
Of course, the derivative of a finite sum is always equal to the sum of the derivatives, as differentiation is a linear operator.  But infinite sums are a different matter. Term-by-term differentiation (or integration) of  an infinite series of functions (e.g. Taylor series, Fourier series, \dots) is only valid if the series <em>converges uniformly</em>. This is a stronger form of convergence than the usual <em>pointwise convergence</em>.
  </p>


  <theorem xml:id="thm-fourier_uni_conv">
    <statement>
      <p>
        The Fourier series of the function <m>f</m> over <m>(-\pi, \pi)</m> is uniformly convergent if <m>f</m> is continuous on <m>(-\pi, \pi)</m>, <m>\frac{df}{dx}</m> is piece-wise continuous on <m>(-\pi, \pi)</m> and <m>f</m> is periodic of period <m>2\pi</m> so that <m>f(-\pi)=f(\pi)</m>.
      </p>
    </statement>
    <proof>
      <p>
        Omitted.
      </p>
    </proof>
  </theorem>
  
  <theorem xml:id="thm-fourier_parseval">
    <title>Parseval's theorem</title>
    <statement>
      <p>
        If <m>f(x)</m> has period <m>2\pi</m> and its Fourier series
<me>
  f(x) = \frac{1}{2} a_0 + \sum_{n=1}^\infty a_n \cos(nx) + \sum_{n=1}^\infty b_n \sin(nx),
  </me>
converges uniformly over <m>(-\pi,\pi)</m> then
<me>
\frac{1}{2\pi} \int_{-\pi}^\pi \left ( f(x) \right )^2 \, dx =
\frac{1}{4} a_0^2 + \frac{1}{2} \sum_{n=1}^\infty \left ( a_n^2 + b_n^2 \right ) .
</me>
      </p>
    </statement>
    <proof>
      <p>
        In lecture.
      </p>
    </proof>
  </theorem>
  <p>
   Parseval's theorem can be used to determine the sum of particular series. 
  </p>
  <example>
    <statement>
      <p>
        The Fourier series for the half-way rectified sine wave
<me>
  f(x) =
\begin{cases}
0 \amp , -\pi \lt x \leq 0 \\
\sin(x) \amp, 0 \lt  x \leq \pi
\end{cases}
,</me>
is the series
<me>
  f(x) = \frac{1}{\pi} + \frac{1}{2} \sin(x) -\frac{2}{\pi} \sum_{n=1}^\infty \frac{1}{4n^2 -1} \cos(2n x).
  </me>
Use Parseval's theorem to find the sum of the series
<me>
\sum_{n=1}^\infty \frac{1}{\left ( 4n^2 - 1 \right )^2}.
</me>
      </p>
    </statement>
    <solution>
      <p>
        In lecture. 
      </p>
    </solution>
  </example>
</section>

<!-- <xi:include href="./integrals01.ptx" /> -->

 </chapter>
