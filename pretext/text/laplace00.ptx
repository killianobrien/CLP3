<?xml version="1.0" encoding="UTF-8" ?>
<chapter xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="chap_laplace">
<!-- Copyright 2018-2020 Joel Feldman, Andrew Rechnitzer and Elyse Yeager -->
<!-- This work is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License-->
<!-- https://creativecommons.org/licenses/by-nc-sa/4.0 -->
<title>Laplace transforms</title>
<introduction>
  <p>
    In this chapter we study Laplace transforms, which give us a method for finding <em>analytic</em><fn>An analytic solution to an ODE is an exact solution typically expressed as some combination of standard functions, as opposed to a <em>numerical solution</em>, which is one developed in an incremental way from some kind of initial or boundary conditions, like you have been studying in the Numerical Methods unit.</fn> solutions to certain linear ordinary differential equations. A key concept for understanding the topics in this chapter is how the Laplace transform takes the original problem, the ODE, and <em>transforms</em> it into a related problem in a different setting that is easier to solve than the original one. The solution to this related problem is then <em>transformed back</em>, using the inverse Laplace transform, to recover the solution to the original ODE.
  </p>
</introduction>
<section xml:id="sec-terminology">
  <title>Terminology</title>
  <definition xml:id="def-de">
  <title>Differential equations</title>
    <statement>
      <p>
          A <em>differential equation</em> is an equation featuring one or more unknown functions and some of their derivatives. If the derivatives are all one-variable standard derivatives, e.g. <m>\frac{dy}{dt}</m> etc, then the equation is called an <em> ordinary differential equation</em> (ODE). If the derivatives are partial, e.g. <m>\frac{\partial y}{\partial t}</m> then the equation is called a <em>partial differential equation</em> (PDE).
      </p>
    </statement>
  </definition>


<p>Differential equations arise in a wide range of applications of mathematics to problems in motion, astronomy, physics, engineering, chemistry, biology , etc. In practice the differential equations one meets are often impossible to solve exactly (i.e. find an <em>analytic solution</em>) and instead we must use techniques to find approximations to the actual solutions (so called <em>numerical solutions</em>). However for special cases of ODEs we can describe methods to obtain exact solutions, one of which we describe in this chapter.</p>

<definition xml:id="def-linearODE">
<title>Linear and non-linear ODEs</title>
  <statement>
      <p>The method described here, Laplace transforms, can often find the exact solution to a <em>linear ordinary differential equation with constant coefficients</em>, i.e. one of the form
<me>
a_n \frac{d^ny}{dt^n} + \dots + a_1 \frac{dy}{dt} + a_0y = g(t),
</me>
where <m>y</m> is the unknown function whose solution is sought. Note that we are allowed a non-constant function <m>g</m> on the right hand side.</p>

<p>A <em>non-linear</em> ODE is one where some of the derivatives of <m>y</m>, or <m>y</m> itself, appear to a power higher than 1 or are multiplied together, such as in
<me>
t^4 \frac{d^2y}{dt^2} + y \frac{dy}{dt} = 0.
</me>
</p>
  </statement>
</definition>

<p>
  Solutions to ODEs will often feature a number of undetermined constants which can be determined if extra information is given in form of <em>boundary conditions</em>, i.e. known values of the solution <m>y</m> at certain points in the domain, or <em>initial conditions</em>, i.e. known values of the solution <m>y(t)</m>  and some of its derivatives at <m>t=0</m>. Such initial values usually come from knowing the initial state of a system, the future behaviour of which will be governed by the ODE.
</p>

<example>
  <statement>
    <p>
      Show how the boundary conditions <m>y(0)=1</m> and <m>y(1)=2</m> determine the constants that arise in the solution of
<me>
\frac{d^2y}{dt^2} = 0.
</me>
    </p>
  </statement>
  <solution>
    <p>
      See lecture.
    </p>
  </solution>
</example>
</section>


<section xml:id="sec-laplace_transform">
  <title>The transform and its properties</title>
<p>
In general a <em>transform</em> of a function, <m>x(t)</m> say, is a rule for associating a new function, <m>X(s)</m> say, to <m>x</m>. The new function depends on a new argument / variable <m>s</m>. The values of the original function <m>x(t)</m> are used somehow to define the new function <m>X</m>.
</p>

<definition xml:id="def-laplace-transform">
<title>Laplace transform</title>
  <statement>
    <p>
      Let <m>f</m> be a function defined on the positive real numbers. The <em>Laplace transform</em> of a function <m>f</m> is a function of a new variable <m>s</m> and is defined by the integral
<me>
\trans{f(t)} .
</me>
Various notations are commonly used for the Laplace transform of <m>f</m>. It can be denoted by any of
<me>
\L{f(t)}, \, \, \bar{f}(s) \text{ or } F(s).
</me>
    </p>
  </statement>
</definition>
<p>
The Laplace transform, <m>F(s)</m> makes sense as a complex valued function of the complex variable <m>s</m>. However we shall only consider it mostly as a function of the real variable <m>s</m>. In fact we shall not be making any particular use of the individual values of <m>F</m>, rather we shall be exploiting the existence of these transforms and their associated properties in order to find solutions to certain ODEs.
</p>
<p>
Of course a function only has a transform if the integral in definition <xref ref="def-laplace-transform"/> converges. This will be so for most of the functions that we meet. In general it is so for functions of <em>exponential type</em>, i.e. functions that eventually are dominated by a suitable exponential function <m>e^{\lambda t}</m>.
</p>

<p>
We can think of the Laplace transform of some kind of continuous analogue of a power series associated to a sequence of coefficients. This viewpoint is excellently described in a <url href="http://ocw.mit.edu/courses/mathematics/18-03-differential-equations-spring-2010/video-lectures/lecture-19-introduction-to-the-laplace-transform">video lecture</url> by Prof. Arthur Mattuck in the MIT OpenCourseWare Differential Equations course.
</p>

<example>
<title>The tranform of the constant function <m>1</m>.</title>
  <statement>
    <p>
      The Laplace transform, <m>\L{1}</m>, of the constant function <m>1</m> is given by 
      <me>
        \L{1} = \frac{1}{s}.
      </me>
    </p>
  </statement>
  <solution>
    <p>
<md>
  <mrow>\L{f(t)} \amp= \trans{1},</mrow>
  <mrow> \amp = \trans{},</mrow>
  <mrow> \amp = \left [ \frac{e^{-st}}{-s} \right ]_0^\infty, </mrow>
  <mrow> \amp = \frac{1}{s}, \text{ for $s>0$}.</mrow>
</md>
    </p>
  </solution>
</example>

<example>
  <title>The transform of the identity function, <m>f(t)=t</m>.</title>
  <statement>
    <p>
      If <m>f</m> is the function defined by <m>f(t) = t</m> for <m>t\geq 0</m> then <m>\L{f(t)}=\frac{1}{s^2}.</m>
    </p>
  </statement>
  <solution>
    <p>
      <md>
        <mrow>\L{f(t)} \amp = \trans{t},</mrow>
        <mrow> \amp = \int_0^\infty t \, \frac{d}{dt} \left ( \frac{e^{-st}}{-s} \right ) \, dt,</mrow>
        <mrow> \amp = \left [ t\,  \frac{e^{-st}}{-s} \right ]_0^\infty - \int_0^\infty \frac{e^{-st}}{-s} \, dt , \text{ int. by parts},</mrow>
        <mrow> \amp = \frac{1}{s} \int_0^\infty e^{-st} \, dt, \text{ for $s>0$},</mrow>
        <mrow> \amp =  \frac{1}{s^2}.</mrow>
      </md>
    </p>
  </solution>
</example>

<example>
  <title>Transform of the exponential</title>
  <statement>
    <p>
      If <m>f</m> is a function of exponential type like <m>f(t) = e^{-at}</m> for <m>t>0</m> and <m>a \in \mathbb{R}</m> then <m>\L{f(t)}=\frac{1}{s-a}</m>
    </p>
  </statement>
  <solution>
    <p>
      <md>
        <mrow>\L{f(t)} \amp = \trans{e^{-at}},</mrow>
        <mrow> \amp = \int_0^\infty e^{-(s+a)t} \, dt,</mrow>
        <mrow> \amp = \frac{1}{s+a}, \text{ for $s+a > 0$}.</mrow>
      </md>
    </p>
  </solution>
</example>
</section>

<section xml:id="sec-laplace_table">
  <title>Table of Laplace transforms</title>
  <p>
    Continuing in this vein we might find the Laplace transforms of all the standard functions that commonly arise in mathematics. However to make things easier, when we need to obtain transforms in practice we shall make use of a table of Laplace transforms, unless told otherwise. In table <xref ref="tab-laplace"/> you can find the transforms of the common functions we will encounter and a summary of some relevant properties of the transform.
  </p>

  <table xml:id="tab-laplace">
  <title>Transforms of common functions</title>
  <tabular top="major">
    <row bottom="minor">
      <cell>
        Function
      </cell>
      <cell>
        Transform <m>L[f(t)] = \displaystyle\int_0^\infty e^-stf(t) \, dt = \bar{f}(s)</m>
      </cell>
    </row>
    <row>
      <cell>
        1
      </cell>
      <cell>
        <m>\dfrac{1}{s}</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>t</m>
      </cell>
      <cell>
        <m>\dfrac{1}{s^2}</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>t^n</m>
      </cell>
      <cell>
        <m>\dfrac{n!}{s^{n+1}} \qquad n</m> is a positive integer
      </cell>
    </row>
    <row>
      <cell>
        <m>e^-at</m>
      </cell>
      <cell>
        <m>\dfrac{1}{s+a}</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>te^-at</m>
      </cell>
      <cell>
        <m>\dfrac{1}{(s+a)^2}</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>t^ne^-at</m>
      </cell>
      <cell>
        <m>\dfrac{n!}{(s+a)^{n+1}}\qquad n</m> is a positive integer
      </cell>
    </row>
    <row>
      <cell>
        <m>\sin(\omega t)</m>
      </cell>
      <cell>
        <m>\dfrac{\omega}{s^2 + \omega^2}</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>\cos(\omega t)</m>
      </cell>
      <cell>
        <m>\dfrac{s}{s^2 + \omega^2}</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>t\sin(\omega t)</m>
      </cell>
      <cell>
        <m>\dfrac{2\omega s}{(s^2 + \omega^2)^2}</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>t\cos(\omega t)</m>
      </cell>
      <cell>
        <m>\dfrac{s^2 - \omega^2}{(s^2 + \omega^2)^2}</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>\sinh(\omega t)</m>
      </cell>
      <cell>
        <m>\dfrac{\omega}{s^2 - \omega^2}</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>\cosh(\omega t)</m>
      </cell>
      <cell>
        <m>\dfrac{s}{s^2 - \omega^2}</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>e^-at\sin(\omega t)</m>
      </cell>
      <cell>
        <m>\dfrac{\omega}{(s+a)^2+\omega^2}</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>e^-at\cos(\omega t)</m>
      </cell>
      <cell>
        <m>\dfrac{s+a}{(s+a)^2+\omega^2}</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>e^-at\sinh(\omega t)</m>
      </cell>
      <cell>
        <m>\dfrac{\omega}{(s+a)^2-\omega^2}</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>e^-at\cosh(\omega t)</m>
      </cell>
      <cell>
        <m>\dfrac{s+a}{(s+a)^2-\omega^2}</m>
      </cell>
    </row>
    <row>
      <cell>
        Unit step function <m>H(t)</m>
      </cell>
      <cell>
        <m>\dfrac{1}{s}</m>
      </cell>
    </row>
    <row>
      <cell>
        Unit impulse function <m>\delta (t)</m>
      </cell>
      <cell>
        1
      </cell>
    </row>
    <row>
      <cell>
        <m>H(t-a)</m>
      </cell>
      <cell>
        <m>\dfrac{1}{s}e^{-as}</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>\delta (t-a)</m>
      </cell>
      <cell>
        <m>e^{-as}</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>e^{-at}f(t)</m>
      </cell>
      <cell>
        <m>\bar{f}(s+a)</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>tf(t)</m>
      </cell>
      <cell>
        <m>-\dfrac{d}{ds} \bar{f}(s)</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>f(t-a)H(t-a)</m>
      </cell>
      <cell>
        <m>e^{-as}\bar{f}(s)</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>\dfrac{dx}{dt}</m>
      </cell>
      <cell>
        <m>s\bar{x}-x_0</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>\dfrac{d^2x}{dt^2}</m>
      </cell>
      <cell>
        <m>s^2\bar{x}-sx_0-x_1</m>
      </cell>
    </row>
    <row>
      <cell>
        <m>\dfrac{d^3x}{dt^3}</m>
      </cell>
      <cell>
        <m>s^3\bar{x}-s^2x_0-sx_1-x_2</m>
      </cell>
    </row>
    <row bottom="major">
      <cell>
        <m>\displaystyle \int_0^t f(t) \, dt</m>
      </cell>
      <cell>
        <m>\dfrac{1}{s}\bar{f}(s)</m>
      </cell>
    </row>
  </tabular>
</table>
</section>

<section xml:id="sec-transform_properties">
  <title>Properties of the transform</title>
  <p>
    We now discuss some important properties of the transform that follow from the definition <xref ref="def-laplace-transform"/> and examples of using them to find transforms of futher functions.
  </p>
  <theorem xml:id="thm-transform_linearity">
  <title>Linearity of the transform</title>
      <statement>
      <p>
        The Laplace transform is linear, i.e. if <m>f</m> and <m>g</m> are two functions with Laplace transforms then for all <m>\alpha, \beta \in \mathbb{R}</m>,
        <me>
          \L{\alpha f + \beta g} = \alpha\L{f} + \beta \L{g}.
        </me>
             </p>
    </statement>
    <proof>
      <p>
        This follows directly from the linearity of integration.
      </p>
    </proof>
  </theorem>
  <example>
  <title>Appying linearity</title>
      <statement>
      <p>
        Find the Laplace transform <m>\L{3t + 4e^{-2t}}</m>.
      </p>
    </statement>
    <solution>
      <p>
        <md>
          <mrow>\L{3t + 4e^{-2t}} \amp = 3 \L{t} + 4 \L{e^{-2t}} , </mrow>
          <mrow> \amp = \frac{3}{s^2} + \frac{4}{s+2}. </mrow>
        </md>
      </p>
    </solution>
  </example>
  <p>
    The next result links the derivative of a transform to the process of multiplying the original function by <m>t</m>.
  </p>
  <theorem xml:id="thm-deriv_of_transform">
  <title>Derivative of the transform</title>
      <statement>
      <p>
        Let <m>f</m> be a function with transform <m>F(s) = \L{f(t)}</m>, then 
        <me>
          \L{tf(t)} = - \frac{dF}{ds}.
        </me>
      </p>
    </statement>
    <proof>
      <p>
        <md>
          <mrow>-\frac{dF}{ds} \amp = - \frac{d}{ds} \left ( \trans{f(t)} \right )  , </mrow>
          <mrow> \amp  =  - \int_0^\infty \frac{\partial}{\partial s} \left ( e^{-st} f(t) \right ) \, dt ,</mrow>
          <mrow> \amp  = - \int_0^\infty -t e^{-st} f(t) \, dt </mrow>
          <mrow> \amp  = \trans{t f(t)}, </mrow>
          <mrow> \amp  = \L{tf(t)}.</mrow>
        </md>
      </p>
    </proof>
  </theorem>
  <p>
    In a previous example we found that <m>\L{t}=\frac{1}{s}</m>. Now we can apply theorem <xref ref="thm-deriv_of_transform"/> to find <m>\L{t^n}</m> for any positive integer <m>n</m>.
  </p>
  
  <example xml:id="eg-trans_poly_term">
  <title>Transforms of polynomial terms</title>
      <statement>
      <p>
      For any integer <m>n\geq 0</m>,
      <me>
        \L{t^n} = \frac{1}{s^{n+1}}
      </me></p>
    </statement>
    <solution>
      <p>
        The base case of <m>\L{t^0}=\L{1}=1/s</m> has already been proven. If <m>\L{t^k} = 1/s^{k+1}</m> then 
        <md>
          <mrow>\L{t^{k+1}} \amp = \L{t \cdot t^k},</mrow>
          <mrow> \amp = -\frac{d}{ds} \left ( \frac{1}{s^{k+1}} \right ),</mrow>
          <mrow> \amp = \frac{1}{s^{k+2}}.</mrow>
        </md>
      and so the result follows by induction on <m>n</m>.
      </p>
    </solution>
  </example>
  <p>
    So now using linearity and example <xref ref="eg-trans_poly_term"/> we can find the transform of any poynomial in <m>t</m>.
  </p>

<p>
  The next property concerns taking the Laplace transform of the derivative of a function. This is a key property that enables the transform to be used as a tool to solve ODEs, as ODEs feature many derivatives of the unknown function that we wish to find.
</p>

<theorem xml:id="thm-trans_deriv">
<title>Transform of a derivative</title>  
  <statement>
    <p>
      Let <m>x</m> be a function having a Laplace transform <m>\L{x(t)}</m>. Then
<me>
\L{\frac{dx}{dt}} = s \L{x(t)} - x(0).
</me>
    </p>
  </statement>
  <proof>
    <p>
      This can be shown using integration by parts, as follows,
      <md>
        <mrow> \L{\frac{dx}{dt}} \amp =\trans{\frac{dx}{dt}} , </mrow>
        <mrow> \amp  =  \left [ e^{-st} x(t) \right ]_0^\infty - \int_0^\infty -se^{-st} x(t) \, dt </mrow>
        <mrow> \amp  = -x(0) + s \trans{x(t)} ,</mrow>
        <mrow> \amp = s \L{x(t)} - x(0),</mrow>
      </md>
      as required.
    </p>
  </proof>
</theorem>
<p>
  The transforms of higher order derivatives can be obtained by iterating this result.
</p>
<corollary xml:id="cor-trans-deriv">
  <statement>
    <p>
      Let <m>x</m> be a function having a Laplace transform <m>\L{x(t)}</m> and let <m>n \geq 1</m>. Then
      <me>
        \L{\frac{d^n x}{dt^n}} = s^n \L{x(t)} - \sum_{i=0}^{n-1} s^{n-1 - i}x_i,
      </me>
      where <m>x_i</m> denotes the initial value of the <m>i</m>th derivative of <m>x</m>, i.e.
      <me>
        x_i = \left. \frac{d^ix}{dt^i} \right |_{t=0}.
      </me>
      
    </p>
  </statement>
  <proof>
    <p>
      Use induction on <m>n</m>, base case provided by theorem <xref ref="thm-trans_deriv"/>.
    </p>
  </proof>
</corollary>
<p>
  Laplace transforms are invertible for most applications, and we will assume that this is the case. So we speak of the <em>inverse Laplace transform</em> of a function <m>F(s)</m> as being the function <m>f(t)</m> whose Laplace transform is <m>F(s)</m>, and we write
<me>
\Linv{F(s)} = f(t).
</me>
So for example <m>\Linv{\frac{1}{s^2}} = t</m> and <m>\Linv{\frac{1}{s-4}} = e^{4t}</m>.
</p>
<p>
The inverse transform of an arbitrary function <m>F(s)</m> can be expressed/evaluated as a certain integral in the complex plane of the product of suitable exponential and <m>F</m>. However for our purposes we think of finding an inverse transform as an exercise in using the Laplace transform table in reverse, although in many cases it will be necessary to use the method of partial fractions as a precursor to this.
</p>
</section>
<section xml:id="sec-ODE_solving">
  <title>Solving ODEs using the transform</title>
  <p>
    We
  </p>
</section>


<!-- <xi:include href="./integrals01.ptx" /> -->

 </chapter>
